function KeyCtroller(e,t,i,o,r){this.keyListerensPlay1={},this.role=e,this.top=t||87,this.right=i||68,this.bottom=o||83,this.left=r||65,this.key87=!0,this.key83=!0,this.key65=!0,this.key68=!0,this.key38=!0,this.key37=!0,this.key40=!0,this.key39=!0,this.keyTop=!0,this.keyRight=!0,this.keyBottom=!0,this.keyLeft=!0,this.dire=[],this.init()}function loadImg(e,t){for(var i={},o=0,r=0;r<e.length;r++){var s=new Image;s.src="./images/"+e[r]+".png",i[e[r]]=s,s.onload=function(){if(o++,game.loadIngGame.drawLoad(o,e.length),o==e.length){t(i),ctxGameloading.globalAlpha=.3;var r=0,s=setInterval(function(){++r>20&&(clearInterval(s),gameloadingCvs.style.display="none"),ctxGameloading.fillStyle="#000",ctxGameloading.fillRect(0,0,gameloadingCvs.width,gameloadingCvs.height)},30)}}}}function loadAudio(e,t){for(var i={},o=0,r=0;r<e.length;r++){var s=new Audio;s.src="./sounds/"+e[r]+".ogg",i[e[r]]=s,s.oncanplay=function(){++o==e.length&&t(i)}}}function createRole(e,t,i,o,r,s,a,l){return new Role({ctxRole:ctxRole,roleImg:e,roleCx:t||200,roleCy:i||200,player1:o,player2:r,ctxBlood:s,bloodImg:a,penBloodImg:l})}function DrawGameBg(e){this.ctxBg=e.ctxBg,this.bgImg=e.bgImg,this.init()}function GameScroe(e){this.ctxGameScore=e.ctxGameScore,this.startImg=e.startImg,this.stopImg=e.stopImg,this.restartImg=e.restartImg,this.bg_musicImg=e.bg_musicImg,this.soundImg=e.soundImg,this.sound2Img=e.sound2Img,this.bg_music2Img=e.bg_music2Img,this.init()}function GameLoad(e){this.ctxGameloading=e.ctxGameloading,this.loadIngImg=e.loadIngImg,this.width=e.width,this.height=e.height,this.cX=e.cX,this.cY=e.cY,this.init()}function PlayGame(e){this.ctxPlayGame=e.ctxPlayGame,this.playGameImg=e.playGameImg,this.playGameImg2=e.playGameImg2,this.init()}function CheckGame(e){this.ctxCheckGame=e.ctxCheckGame,this.check_view=e.check_view,this.check_view_top=e.check_view_top,this.check_view_bottom=e.check_view_bottom,this.check1=e.check1,this.check2=e.check2,this.check3=e.check3,this.check4=e.check4,this.check5=e.check5,this.check6=e.check6,this.check7=e.check7,this.check8=e.check8,this.single=e.single,this.double=e.double,this.temp=null,this.callbackIn=e.callbackIn,this.init()}function PauseGame(e){this.ctxPauseGame=e.ctxPauseGame,this.globalAlpha=e.globalAlpha||.8,this.init()}function GameOver(e){this.ctxGameOver=e.ctxGameOver,this.gameOverImg=e.gameOverImg,this.init()}function Obstacle(e){this.ctxObstacle=e.ctxObstacle,this.obstacleImg=e.obstacleImg,this.init()}function Role(e){this.ctxRole=e.ctxRole,this.roleImg=e.roleImg,this.roleCx=e.roleCx,this.roleCy=e.roleCy,this.roleSpeed=e.roleSpeed||2,this.roleTempSpeed=this.roleSpeed,this.player1=e.player1,this.player2=e.player2,this.killRang=e.killRang||config.killRang,this.attachTime=config.attachTime,this.roleBody=.25,this.keyListerensPlay1={},this.keyListerensPlay2={},this.dire=[],this.moving=!1,this.bulletIng=[],this.isDie=!1,this.nBGun=0,this.mineNum=3,this.pretend=!1,this.roleTopKey=e.roleTopKey||87,this.roleRightKey=e.roleRightKey||68,this.roleLeftKey=e.roleLeftKey||65,this.rolebottomKey=e.rolebottomKey||83,this.roleX=0,this.roleY=0,this.roleW=this.roleImg.width/8,this.roleH=this.roleImg.height/8,this.roundZombie=0,this.roleIndex=0,this.toTop=!1,this.toRight=!1,this.toBottom=!1,this.toLeft=!1,this.ctxBlood=e.ctxBlood,this.bloodImg=e.bloodImg,this.bloodW=this.bloodImg.width/4,this.bloodH=this.bloodImg.height/8,this.penBloodImg=e.penBloodImg,this.penBloodW=this.penBloodImg.width,this.penBloodH=this.penBloodImg.height,this.init()}function Bullet(e,t,i){this.x=e,this.y=t,this.dire=i}function Zombie(e){this.ctxZombie=e.ctxZombie,this.zombieImg=e.zombieImg,this.zombieW=this.zombieImg.width/8,this.zombieH=this.zombieImg.height/9,this.ctxZomdie=e.ctxZomdie,this.zomDieImg=e.zomDieImg,this.zomDieW=this.zomDieImg.width,this.zomDieH=this.zomDieImg.height/4,this.temp=0,this.zombieArr=[],this.init(),this.zombieAttack=[]}function CreateGas(e){this.ctxGas=e.ctxGas,this.gasImg=e.gasImg,this.bombArr=e.bombArr,this.gasW=this.gasImg.width,this.gasH=this.gasImg.height,this.bombImg=e.bombImg,this.bombIndex=0,this.bombW=this.bombImg.width,this.bombH=this.bombImg.height/10,this.init()}function Mine(e){this.mineImg=e.mineImg,this.ctxMine=e.ctxMine,this.ctxMineEffect=e.ctxMineEffect,this.ctxGas=e.ctxGas,this.mineImgW=this.mineImg.width,this.mineImgH=this.mineImg.height/4,this.mineeffectImg=e.mineeffectImg,this.mineeffectImgW=this.mineeffectImg.width,this.mineeffectImgH=this.mineeffectImg.height/10,this.mineArr=[],this.timer=null}function GameProp(e){this.ctxGameProp=e.ctxGameProp,this.propImg=e.propImg,this.propImgW=this.propImg.width,this.propImgH=this.propImg.height/5,this.propType}function SailorGame(e){this.audioObj=["bkg","enter","zhuji","buqian","baozha-da3"],this.imgObj=["play_view","play_view2","check_view","check_view_bottom","check_view_top","check1","check2","check3","check4","check5","check6","check7","check8","gameOver","propimg","pretend","start","stop","restart","bg_music","sound","sound2","bg_music2","single","mine","mineeffect","double","bg_1","bg_2","bg_3","bg_4","bg_5","bg_6","bg_7","bg_8","obstacle_1","obstacle_2","obstacle_3","obstacle_4","obstacle_5","obstacle_6","obstacle_7","obstacle_8","role","role2","roleDie","zombie","bullet_1","bullet_2","bullet_3","bullet_5","bullet_6","bullet_7","bullet_8","bullet_4","gas","bombeffect","blood","penBlood","zomDie"],this.playView=null,this.checkView=null,this.pauseGame=null,this.overGame=null,this.scroeGame=null,this.loadIngGame=null,this.propGame=null,this.mineProp=null,this.role=null,this.role2=null,this.zombie=null,this.gas=null,this.dobuleRole=null,this.gameBg,this.gameObstacle,this.roleXY={},this.roleCtrl1,this.roleCtrl2,this.isPause=!1,this.isGameOver=!1,this.gameCount=1}var config={temps:null,tempsIndex:0,tempsFn:function(){config.tempsIndex++,config.tempsIndex%10!=0&&5!=config.tempsIndex||game.propGame.drawProp()},audios:null,imgobj:null,drawText:function(e){game.overGame.drawGameOver();for(var t=["0","0","0","0","0","0"],i=e.split("").reverse(),o=0;o<i.length;o++)t[t.length-o-1]=i[o];var r=t.join("");ctxGameOver.font="60px 微软雅黑",ctxGameOver.fillStyle="#000",ctxGameOver.fillText(r,502,435)},createZombieTime:null,attachTime:4,dobuleRole:!0,hasMusic:!0,hasSound:!0,killRang:20,checked:0,gameBg:[["bg_1","obstacle_1"],["bg_2","obstacle_2"],["bg_3","obstacle_3"],["bg_4","obstacle_4"],["bg_5","obstacle_5"],["bg_6","obstacle_6"],["bg_7","obstacle_7"],["bg_8","obstacle_8"]],bombArr:[[{isBomb:!1,x:206,y:139},{isBomb:!1,x:206,y:370},{isBomb:!1,x:600,y:175},{isBomb:!1,x:996,y:139},{isBomb:!1,x:996,y:370}],[{isBomb:!1,x:410,y:64},{isBomb:!1,x:136,y:281},{isBomb:!1,x:630,y:350},{isBomb:!1,x:1014,y:199}],[{isBomb:!1,x:80,y:284},{isBomb:!1,x:359,y:373},{isBomb:!1,x:428,y:215},{isBomb:!1,x:1003,y:228}],[{isBomb:!1,x:470,y:227},{isBomb:!1,x:718,y:227},{isBomb:!1,x:159,y:330},{isBomb:!1,x:1039,y:330},{isBomb:!1,x:402,y:573},{isBomb:!1,x:529,y:573},{isBomb:!1,x:661,y:573},{isBomb:!1,x:788,y:573}],[{isBomb:!1,x:282,y:162},{isBomb:!1,x:88,y:441},{isBomb:!1,x:313,y:342},{isBomb:!1,x:587,y:146},{isBomb:!1,x:660,y:421},{isBomb:!1,x:1065,y:241}],[{isBomb:!1,x:323,y:150},{isBomb:!1,x:423,y:150},{isBomb:!1,x:523,y:150},{isBomb:!1,x:623,y:150},{isBomb:!1,x:723,y:150},{isBomb:!1,x:823,y:150},{isBomb:!1,x:923,y:150},{isBomb:!1,x:1023,y:150},{isBomb:!1,x:1123,y:150}],[{isBomb:!1,x:318,y:150},{isBomb:!1,x:509,y:150},{isBomb:!1,x:700,y:150},{isBomb:!1,x:891,y:150},{isBomb:!1,x:318,y:472},{isBomb:!1,x:509,y:472},{isBomb:!1,x:700,y:472},{isBomb:!1,x:891,y:472}],[{isBomb:!1,x:489,y:269},{}]],obstacle:[[{x:310,y:139,w:109,h:94},{x:310,y:370,w:109,h:94},{x:546,y:31,w:109,h:84},{x:780,y:139,w:109,h:94},{x:780,y:370,w:109,h:94},{x:431,y:256,w:340,h:94},{x:196,y:506,w:810,h:94}],[{x:111,y:84,w:102,h:94},{x:303,y:117,w:102,h:94},{x:512,y:33,w:102,h:94},{x:742,y:78,w:102,h:94},{x:931,y:32,w:102,h:94},{x:1018,y:284,w:102,h:94},{x:810,y:234,w:102,h:94},{x:915,y:477,w:102,h:94},{x:697,y:364,w:102,h:94},{x:511,y:478,w:102,h:94},{x:437,y:286,w:102,h:94},{x:226,y:259,w:102,h:94},{x:93,y:392,w:102,h:94},{x:257,y:464,w:102,h:94}],[{x:0,y:456,w:1200,h:144},{x:0,y:0,w:1200,h:170},{x:167,y:141,w:137,h:144},{x:767,y:228,w:137,h:171}],[{x:298,y:85,w:149,h:86},{x:486,y:85,w:90,h:86},{x:615,y:85,w:90,h:86},{x:742,y:85,w:149,h:86},{x:298,y:478,w:147,h:86},{x:744,y:478,w:147,h:86},{x:486,y:478,w:88,h:86},{x:615,y:478,w:88,h:86}],[{x:415,y:130,w:129,h:40},{x:701,y:194,w:98,h:46},{x:0,y:491,w:1200,h:109}],[{x:210,y:265,w:184,h:70},{x:428,y:310,w:176,h:64},{x:853,y:235,w:40,h:65},{x:893,y:235,w:100,h:80}],[{x:176,y:116,w:92,h:64},{x:176,y:280,w:92,h:64},{x:176,y:447,w:92,h:64},{x:367,y:116,w:92,h:64},{x:367,y:280,w:92,h:64},{x:367,y:447,w:92,h:64},{x:558,y:116,w:92,h:64},{x:558,y:447,w:92,h:64},{x:749,y:116,w:92,h:64},{x:749,y:280,w:92,h:64},{x:749,y:447,w:92,h:64},{x:940,y:116,w:92,h:64},{x:940,y:280,w:92,h:64},{x:940,y:447,w:92,h:64},{x:532,y:275,w:131,h:60}],[{x:122,y:249,w:197,h:20},{x:91,y:269,w:248,h:34},{x:106,y:303,w:223,h:10},{x:124,y:313,w:180,h:10},{x:451,y:383,w:211,h:67},{x:662,y:405,w:34,h:45},{x:710,y:254,w:194,h:43},{x:710,y:297,w:176,h:14},{x:0,y:0,w:1200,h:112}]]},util={extend:function(){for(var e=arguments,t=e[0],i=null,o=1;o<e.length;o++){i=e[o];for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}},random:function(e,t){return e=e||0,t=t||0,Math.random()*(t-e)+e},clearCtx:function(e,t,i){e.clearRect(0,0,t,i)},deleObjInArr:function(e,t){var i=util.getIndex(e,t);i>-1&&e.splice(i,1)},getIndex:function(e,t){for(var i=!0,o=0;o<e.length;o++){for(var r in e[o])e[o][r]!=t[r]&&(i=!1);if(i)return o;i=!0}},isObstacle:function(e,t,i){return!!e.isPointInPath(t,i)}},roleCvs=document.getElementById("roleCvs"),ctxRole=roleCvs.getContext("2d"),bulletCvs=document.getElementById("bulletCvs"),ctxBullet=bulletCvs.getContext("2d"),bulletObj={},zombieCvs=document.getElementById("zombieCvs"),ctxZombie=zombieCvs.getContext("2d"),bgCvs=document.getElementById("bgCvs"),ctxBg=bgCvs.getContext("2d"),obstacleCvs=document.getElementById("obstacleCvs"),ctxObstacle=obstacleCvs.getContext("2d"),buterCvs=document.getElementById("buterCvs"),ctxButer=buterCvs.getContext("2d"),dieZombieCvs=document.getElementById("dieZombieCvs"),ctxZomdie=dieZombieCvs.getContext("2d"),bloodCvs=document.getElementById("bloodCvs"),ctxBlood=bloodCvs.getContext("2d"),gasCvs=document.getElementById("gasCvs"),ctxGas=gasCvs.getContext("2d"),playGameCvs=document.getElementById("playGameCvs"),ctxPlayGame=playGameCvs.getContext("2d"),checkGameCvs=document.getElementById("checkGameCvs"),ctxCheckGame=checkGameCvs.getContext("2d"),pauseGameCvs=document.getElementById("pauseGameCvs"),ctxPauseGame=pauseGameCvs.getContext("2d"),gameOverCvs=document.getElementById("gameOverCvs"),ctxGameOver=gameOverCvs.getContext("2d"),gameScoreCvs=document.getElementById("gameScoreCvs"),ctxGameScore=gameScoreCvs.getContext("2d"),gameloadingCvs=document.getElementById("gameloadingCvs"),ctxGameloading=gameloadingCvs.getContext("2d"),gamePropCvs=document.getElementById("gamePropCvs"),ctxGameProp=gamePropCvs.getContext("2d"),mineCvs=document.getElementById("mineCvs"),ctxMine=mineCvs.getContext("2d"),mineEffectCvs=document.getElementById("mineEffectCvs"),ctxMineEffect=mineEffectCvs.getContext("2d");util.extend(KeyCtroller.prototype,{init:function(){this.event()},event:function(){var e=this;document.addEventListener("keydown",function(t){var i=t.keyCode;if(e.role.player1&&(game.role.isDie||81==i&&game.role.mineNum>0&&(game.role.mineNum--,game.mineProp.mineArr.push({timing:4,x:game.role.roleCx+game.role.roleW/2,y:game.role.roleCy+game.role.roleH/2}),game.mineProp.timingDraw())),e.role.player2&&(game.role2.isDie||222==i&&game.role2.mineNum>0&&(game.role2.mineNum--,game.mineProp.mineArr.push({timing:4,x:game.role2.roleCx+game.role2.roleW/2,y:game.role2.roleCy+game.role2.roleH/2}),game.mineProp.timingDraw())),e.keyListerensPlay1[i]=i,e.roleMove(),32==i&&e.role.player1&&e.role.attachTime==config.attachTime){if(e.role.shoot(e.role.roleX),e.role.nBGun>0){var o=5;e.role.nBGun--;s=setInterval(function(){o--,e.role.shoot(e.role.roleX),o<=0&&clearInterval(s)},60)}e.role.attachTime=0}if(13==i&&e.role.player2&&e.role.attachTime==config.attachTime){if(e.role.shoot(e.role.roleX),e.role.nBGun>0){var r=5;e.role.nBGun--;var s=setInterval(function(){--r<=0&&clearInterval(s)},60)}e.role.attachTime=0}}),document.addEventListener("keyup",function(t){var i=t.keyCode;i==e.top&&(e.keyTop=!0,e.role.toTop=!1),i==e.right&&(e.keyRight=!0,e.role.toRight=!1),i==e.bottom&&(e.keyBottom=!0,e.role.toBottom=!1),i==e.left&&(e.keyLeft=!0,e.role.toLeft=!1),delete e.keyListerensPlay1[i],setTimeout(function(){var t=e.dire.indexOf(i);t>-1&&e.dire.splice(t,1)},80)}),this.roleMove()},roleMove:function(){for(var e in this.keyListerensPlay1)this.keyListerensPlay1.hasOwnProperty(e)&&(!1,e==this.top&&this.keyTop&&(this.keyTop=!1,this.role.toTop=!0,this.dire.push(this.top)),e==this.right&&this.keyRight&&(this.keyRight=!1,this.role.toRight=!0,this.dire.push(this.right)),e==this.bottom&&this.keyBottom&&(this.keyBottom=!1,this.role.toBottom=!0,this.dire.push(this.bottom)),e==this.left&&this.keyLeft&&(this.keyLeft=!1,this.role.toLeft=!0,this.dire.push(this.left)))},moveStep:function(){this.role.toTop&&(this.role.roleCy-=this.role.roleSpeed,this.role.roleX=4*this.role.roleW,this.isRevers()&&(this.role.roleCy+=this.role.roleSpeed)),this.role.toLeft&&(this.role.roleCx-=this.role.roleSpeed,this.role.roleX=2*this.role.roleW,this.isRevers()&&(this.role.roleCx+=this.role.roleSpeed)),this.role.toRight&&(this.role.roleCx+=this.role.roleSpeed,this.role.roleX=6*this.role.roleW,this.isRevers()&&(this.role.roleCx-=this.role.roleSpeed)),this.role.toBottom&&(this.role.roleCy+=this.role.roleSpeed,this.role.roleX=0*this.role.roleW,this.isRevers()&&(this.role.roleCy-=this.role.roleSpeed)),this.dire=this.dire.slice(-2,this.dire.length),this.dire!=[]&&((this.dire[0]==this.top&&this.dire[1]==this.right||this.dire[1]==this.top&&this.dire[0]==this.right)&&(this.role.roleX=5*this.role.roleW),(this.dire[0]==this.right&&this.dire[1]==this.bottom||this.dire[1]==this.right&&this.dire[0]==this.bottom)&&(this.role.roleX=7*this.role.roleW),(this.dire[0]==this.bottom&&this.dire[1]==this.left||this.dire[1]==this.bottom&&this.dire[0]==this.left)&&(this.role.roleX=1*this.role.roleW),(this.dire[0]==this.left&&this.dire[1]==this.top||this.dire[1]==this.left&&this.dire[0]==this.top)&&(this.role.roleX=3*this.role.roleW)),this.role.moving=0!=this.dire.length},isRevers:function(){return util.isObstacle(ctxObstacle,this.role.roleCx+this.role.roleW/2,this.role.roleCy+this.role.roleH/2)}}),util.extend(DrawGameBg.prototype,{init:function(){this.drawBg()},drawBg:function(){this.ctxBg.drawImage(this.bgImg,0,0)}}),util.extend(GameScroe.prototype,{init:function(){this.drawPause(),this.drawMusic(),this.drawSound(),this.drawReStart(),this.event();var e=this;setInterval(function(){e.drawScroe(config.tempsIndex+"")},1e3)},drawScroe:function(e){ctxGameScore.clearRect(502,0,230,70);for(var t=["0","0","0","0","0","0"],i=e.split("").reverse(),o=0;o<i.length;o++)t[t.length-o-1]=i[o];var r=t.join("");ctxGameScore.font="900 60px 微软雅黑",ctxGameScore.fillStyle="#fff",ctxGameScore.lineWidth=2,ctxGameScore.strokeStyle="#000",ctxGameScore.fillText(r,502,60),ctxGameScore.strokeText(r,502,60)},drawPause:function(e){e?this.ctxGameScore.drawImage(this.startImg,0,0,66,66,356,2,66,66):this.ctxGameScore.drawImage(this.stopImg,0,0,66,66,356,2,66,66)},drawMusic:function(e){e?this.ctxGameScore.drawImage(this.bg_music2Img,0,0,66,66,735,2,66,66):this.ctxGameScore.drawImage(this.bg_musicImg,0,0,66,66,735,2,66,66)},drawSound:function(e){e?this.ctxGameScore.drawImage(this.sound2Img,0,0,66,66,809,2,66,66):this.ctxGameScore.drawImage(this.soundImg,0,0,66,66,809,2,66,66)},drawReStart:function(){this.ctxGameScore.drawImage(this.restartImg,0,0,66,66,429,2,66,66)},event:function(){var e=this;gameScoreCvs.onclick=function(t){t.stopPropagation(),config.hasSound&&config.audios.enter.play(),t.offsetY>2&&t.offsetY<68&&(t.offsetX>429&&t.offsetX<495&&game.gameOverLogic(),t.offsetX>356&&t.offsetX<422&&(game.pause(),e.drawPause(game.isPause)),t.offsetX>809&&t.offsetX<875&&(config.hasSound=!config.hasSound,e.drawSound(!config.hasSound)),t.offsetX>735&&t.offsetX<801&&(config.hasMusic=!config.hasMusic,config.hasMusic?(config.audios.bkg.loop=!0,config.audios.bkg.play()):config.audios.bkg.pause(),e.drawMusic(!config.hasMusic)))}}}),util.extend(GameLoad.prototype,{init:function(){this.ctxGameloading.drawImage(this.loadIngImg,0,0)},drawLoad:function(e,t){this.ctxGameloading.fillStyle="#ffe5e5",this.ctxGameloading.fillRect(this.cX,this.cY,e/t*this.width,this.height)}}),util.extend(PlayGame.prototype,{init:function(){this.drawPlayGame(),this.event()},drawPlayGame:function(){this.ctxPlayGame.drawImage(this.playGameImg,0,0)},event:function(){var e=this;playGameCvs.onmousemove=function(t){t.stopPropagation(),t.offsetX>315&&t.offsetX<553&&t.offsetY>277&&t.offsetY<359?(e.ctxPlayGame.clearRect(0,0,playGameCvs.width,playGameCvs.height),e.ctxPlayGame.drawImage(e.playGameImg2,0,0)):(e.ctxPlayGame.clearRect(0,0,playGameCvs.width,playGameCvs.height),e.ctxPlayGame.drawImage(e.playGameImg,0,0))},playGameCvs.onclick=function(e){e.stopPropagation(),config.hasSound&&config.audios.enter.play(),e.offsetX>315&&e.offsetX<553&&e.offsetY>277&&e.offsetY<359&&(playGameCvs.style.display="none")}}}),util.extend(CheckGame.prototype,{init:function(){this.drawCheckGame(this.check_view_top,0,0),this.drawCheckGame(this.check_view_bottom,0,421),this.event()},drawCheckGame:function(e,t,i){this.ctxCheckGame.drawImage(e,t,i)},event:function(e){var t=this;checkGameCvs.onclick=function(e){config.hasSound&&config.audios.enter.play(),e.stopPropagation(),e.offsetY>153&&e.offsetY<277&&(e.offsetX>250&&e.offsetX<414&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check1,243,143),config.checked=0),e.offsetX>428&&e.offsetX<592&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check2,421,143),config.checked=1),e.offsetX>607&&e.offsetX<771&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check3,600,143),config.checked=2),e.offsetX>785&&e.offsetX<949&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check4,778,143),config.checked=3)),e.offsetY>290&&e.offsetY<414&&(e.offsetX>250&&e.offsetX<414&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check5,243,281),config.checked=4),e.offsetX>428&&e.offsetX<592&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check6,421,281),config.checked=5),e.offsetX>607&&e.offsetX<771&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check7,600,281),config.checked=6),e.offsetX>785&&e.offsetX<949&&(t.ctxCheckGame.clearRect(0,0,checkGameCvs.width,checkGameCvs.height-179),t.drawCheckGame(t.check_view_top,0,0),t.drawCheckGame(t.check8,778,281),config.checked=7)),e.offsetX>547&&e.offsetX<725&&(e.offsetY>445&&e.offsetY<499&&(checkGameCvs.style.display="none",game.isGameOver=!1,clearInterval(config.temps),config.temps=setInterval(function(){config.tempsFn()},1e3),config.dobuleRole=!1,game.process(),game.render()),e.offsetY>502&&e.offsetY<556&&(checkGameCvs.style.display="none",game.isGameOver=!1,clearInterval(config.temps),config.temps=setInterval(function(){config.tempsFn()},1e3),config.dobuleRole=!0,game.process(),game.render())),e.offsetX>66&&e.offsetX<333&&e.offsetY>0&&e.offsetY<98&&(config.hasSound&&config.audios.enter.play(),playGameCvs.style.display="block")},checkGameCvs.onmousemove=function(e){e.stopPropagation(),e.offsetX>547&&e.offsetX<725&&(e.offsetY>446&&e.offsetY<500&&(t.ctxCheckGame.clearRect(0,421,checkGameCvs.width,checkGameCvs.height-421),t.drawCheckGame(t.check_view_bottom,0,421),t.drawCheckGame(t.single,459,446)),e.offsetY>502&&e.offsetY<556&&(t.ctxCheckGame.clearRect(0,421,checkGameCvs.width,checkGameCvs.height-421),t.drawCheckGame(t.check_view_bottom,0,421),t.drawCheckGame(t.double,459,502)))}}}),util.extend(PauseGame.prototype,{init:function(){pauseGameCvs.style.display="none",this.ctxPauseGame.globalAlpha=this.globalAlpha,this.drawPause()},drawPause:function(){this.ctxPauseGame.fillRect(0,0,pauseGameCvs.width,pauseGameCvs.height)}}),util.extend(GameOver.prototype,{init:function(){gameOverCvs.style.display="none",this.drawGameOver(),this.event()},drawGameOver:function(){this.ctxGameOver.drawImage(this.gameOverImg,0,0)},event:function(){gameOverCvs.onclick=function(e){e.stopPropagation(),config.hasSound&&config.audios.enter.play(),game.gameOverLogic()}}}),util.extend(Obstacle.prototype,{init:function(){this.drawObstacle()},drawObstacle:function(){this.ctxObstacle.clearRect(0,0,obstacleCvs.width,obstacleCvs.height),this.ctxObstacle.beginPath(),this.ctxObstacle.drawImage(this.obstacleImg,0,0);for(var e=0;e<config.obstacle[config.checked].length;e++){var t=config.obstacle[config.checked][e];this.ctxObstacle.rect(t.x,t.y,t.w,t.h)}}}),util.extend(Role.prototype,{init:function(){this.roleDraw()},roleDraw:function(){if(this.roleCx<0&&(this.roleCx+=this.roleSpeed||0),this.roleCx>roleCvs.width-40&&(this.roleCx-=this.roleSpeed),this.roleCy<0&&(this.roleCy+=this.roleSpeed||0),this.roleCy>roleCvs.height-40&&(this.roleCy-=this.roleSpeed||0),ctxGas.isPointInPath(this.roleCx+this.roleW/2,this.roleCy+this.roleH/2)&&(this.isDie=!0,this.roleImg=config.RoleDieImg),ctxGameProp.isPointInPath(this.roleCx+this.roleW/2,this.roleCy+this.roleH/2)){if(this.player1)if(0==game.propGame.propType)this.nBGun+=10;else if(1==game.propGame.propType){this.roleSpeed=4,this.roleTempSpeed=4;e=this;setTimeout(function(){e.roleSpeed=2,e.roleTempSpeed=2},5e3)}else if(3==game.propGame.propType)this.mineNum+=5;else if(2==game.propGame.propType)if(game.role.isDie);else{e=this;this.pretend=!0,this.roleImg=config.imgobj.pretend,setTimeout(function(){e.pretend=!1,e.roleImg=config.imgobj.role},5e3)}else 4==game.propGame.propType&&game.dobuleRole&&(game.role2.isDie=!1,game.role2.roleImg=config.imgobj.role2);if(this.player2)if(0==game.propGame.propType)this.nBGun+=10;else if(1==game.propGame.propType){this.roleSpeed=4,this.roleTempSpeed=4;e=this;setTimeout(function(){e.roleSpeed=2,e.roleTempSpeed=2},5e3)}else if(4==game.propGame.propType)this.mineNum+=5;else if(2==game.propGame.propType)if(game.role2.isDie);else{var e=this;this.pretend=!0,this.roleImg=config.imgobj.pretend,setTimeout(function(){e.pretend=!1,e.roleImg=config.imgobj.role2},5e3)}else 3==game.propGame.propType&&(game.role.isDie=!1,game.role.roleImg=config.imgobj.role);ctxGameProp.clearRect(0,0,gamePropCvs.width,gamePropCvs.height),ctxGameProp.beginPath()}this.moving&&(this.roleY=this.roleH*Math.floor(this.roleIndex/4),this.roleIndex++,this.roleIndex>31&&(this.roleIndex=0)),this.ctxRole.drawImage(this.roleImg,this.roleX,this.roleY,this.roleW,this.roleH,this.roleCx,this.roleCy,this.roleW,this.roleH)},clearRole:function(){var e=this;util.clearCtx(e.ctxRole,roleCvs.width,roleCvs.height),ctxBullet.clearRect(0,0,roleCvs.width,roleCvs.height),ctxBullet.beginPath()},shoot:function(e){if(!this.isDie){switch(config.hasSound&&(config.audios.buqian.currentTime=0,config.audios.buqian.play()),e){case 172:var t=this.roleCx+this.roleW/2+(6*Math.random()-3),i=this.roleCy+(6*Math.random()-3);break;case 215:var t=this.roleCx+this.roleW+(6*Math.random()-3),i=this.roleCy+(6*Math.random()-3);break;case 258:var t=this.roleCx+this.roleW+(6*Math.random()-3),i=this.roleCy+this.roleH/2+(6*Math.random()-3);break;case 301:var t=this.roleCx+this.roleW+(6*Math.random()-3),i=this.roleCy+this.roleH+(6*Math.random()-3);break;case 0:var t=this.roleCx+this.roleW/2+(6*Math.random()-3),i=this.roleCy+this.roleH+(6*Math.random()-3);break;case 43:var t=this.roleCx+(6*Math.random()-3),i=this.roleCy+this.roleH/2+(6*Math.random()-3);break;case 86:var t=this.roleCx+(6*Math.random()-3),i=this.roleCy+this.roleH/4+(6*Math.random()-3);break;case 129:var t=this.roleCx+(6*Math.random()-3),i=this.roleCy+(6*Math.random()-3)}this.bulletIng[this.bulletIng.length]={x:t,y:i,dire:e,index:60}}},createBullet:function(e){if(this.isShooted(e),this.attachTime++,this.attachTime>=config.attachTime&&(this.attachTime=config.attachTime),this.bulletIng.length>=0)for(var t=0;t<this.bulletIng.length;t++){var i=this.bulletFly(this.bulletIng[t].x,this.bulletIng[t].y,this.bulletIng[t].dire,this.bulletIng[t].index,e);i&&(this.bulletIng[t]=i)}},isShooted:function(e,t){for(var i=0;i<e.length;i++)if(!(e[i].life<0)){var o=e[i].x+this.roleW/2,r=e[i].y+this.roleH/2;if(ctxBullet.isPointInPath(o,r))return e[i].life--,e[i].backUpTime=10,this.backUp(t,e[i],3,!1),ctxBullet.beginPath(),ctxBullet.clearRect(0,0,1200,600),!1}return!0},bulletFly:function(e,t,i,o,r){var s=this;if(ctxBullet.beginPath(),ctxBullet.arc(e,t,this.killRang,0,2*Math.PI),ctxBullet.closePath(),o<0)util.deleObjInArr(s.bulletIng,{x:e,y:t,dire:i,index:o});else if(this.isShooted(r,i)){for(var a=0;a<config.bombArr[config.checked].length;a++){var l=config.bombArr[config.checked][a];if(!l.isBomb){var m=l.x,h=l.y;if(ctxBullet.isPointInPath(m,h))return util.deleObjInArr(s.bulletIng,{x:e,y:t,dire:i,index:o}),l.isBomb=!0,void game.gas.drawBombScope(m,h)}}if(!util.isObstacle(ctxObstacle,e,t)){switch(o--,i){case 172:ctxBullet.clearRect(e,t,bulletObj.bulletImg.width,bulletObj.bulletImg.height),t-=14,ctxBullet.drawImage(bulletObj.bulletImg,e,t);break;case 215:ctxBullet.clearRect(e,t,bulletObj.bulletImg2.width,bulletObj.bulletImg2.height),e+=14,t-=14,ctxBullet.drawImage(bulletObj.bulletImg2,e,t);break;case 258:ctxBullet.clearRect(e,t,bulletObj.bulletImg3.width,bulletObj.bulletImg3.height),e+=14,ctxBullet.drawImage(bulletObj.bulletImg3,e,t);break;case 301:ctxBullet.clearRect(e,t,bulletObj.bulletImg4.width,bulletObj.bulletImg4.height),e+=14,t+=14,ctxBullet.drawImage(bulletObj.bulletImg4,e,t);break;case 0:ctxBullet.clearRect(e,t,bulletObj.bulletImg5.width,bulletObj.bulletImg5.height),t+=14,ctxBullet.drawImage(bulletObj.bulletImg5,e-this.roleW/4,t);break;case 43:ctxBullet.clearRect(e,t-this.roleH/2,bulletObj.bulletImg6.width,bulletObj.bulletImg6.height),e-=14,t+=14,ctxBullet.drawImage(bulletObj.bulletImg6,e,t-this.roleH/2);break;case 86:ctxBullet.clearRect(e,t-this.roleH/5,bulletObj.bulletImg7.width,bulletObj.bulletImg7.height),e-=14,ctxBullet.drawImage(bulletObj.bulletImg7,e,t-this.roleH/5);break;case 129:ctxBullet.clearRect(e,t,bulletObj.bulletImg8.width,bulletObj.bulletImg8.height),t-=14,e-=14,ctxBullet.drawImage(bulletObj.bulletImg8,e,t)}return{x:e,y:t,dire:i,index:o}}util.deleObjInArr(s.bulletIng,{x:e,y:t,dire:i,index:o})}else util.deleObjInArr(s.bulletIng,{x:e,y:t,dire:i,index:o})},backUp:function(e,t,i,o){function r(){if(t.backUpTime--,o)switch(e){case 0:t.x=t.x,t.y=t.y-i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.y=t.y+i);break;case 1:t.x=t.x+i,t.y=t.y-i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x-i,t.y=t.y+i);break;case 2:t.x=t.x+i,t.y=t.y,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x-i);break;case 3:t.x=t.x+i,t.y=t.y+i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x-i,t.y=t.y-i);break;case 4:t.x=t.x,t.y=t.y+i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.y=t.y-i);break;case 5:t.x=t.x-i,t.y=t.y+i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x+i,t.y=t.y-i);break;case 6:t.x=t.x-i,t.y=t.y,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x+i);break;case 7:t.x=t.x-i,t.y=t.y-i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x+i,t.y=t.y+i)}else{switch(e){case 172:t.x=t.x,t.y=t.y-i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.y=t.y+i);break;case 215:t.x=t.x+i,t.y=t.y-i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x-i,t.y=t.y+i);break;case 258:t.x=t.x+i,t.y=t.y,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x-i);break;case 301:t.x=t.x+i,t.y=t.y+i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x-i,t.y=t.y-i);break;case 0:t.x=t.x,t.y=t.y+i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.y=t.y-i);break;case 43:t.x=t.x-i,t.y=t.y+i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x+i,t.y=t.y-i);break;case 86:t.x=t.x-i,t.y=t.y,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x+i);break;case 129:t.x=t.x-i,t.y=t.y-i,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x=t.x+i,t.y=t.y+i)}s.drawPenBlood(t,e,a)}t.backUpTime>0?window.requestAnimationFrame(r):(t.backUpTime=0,ctxButer.clearRect(0,0,roleCvs.width,roleCvs.height)),s.drawBlood(e,t.x+t.zombieW/2,t.y+t.zombieH/2)}var s=this;switch(e){case 0:a=Math.PI*(45*Math.random()+67.5+180)/180;break;case 43:a=Math.PI*(45*Math.random()+112.5+180)/180;break;case 86:a=Math.PI*(45*Math.random()+157.5+180)/180;break;case 129:a=Math.PI*(45*Math.random()+202.5+180)/180;break;case 172:a=Math.PI*(45*Math.random()+247.5+180)/180;break;case 215:a=Math.PI*(45*Math.random()+292.5+180)/180;break;case 258:a=Math.PI*(45*Math.random()+337.5+180)/180;break;case 301:var a=Math.PI*(45*Math.random()+382.5+180)/180}r(),t.zombieIndex=0},drawBlood:function(e,t,i){var o=Math.floor(8*Math.random());if(172==e||0==e)r=3;else if(43==e||215==e)r=1;else if(86==e||258==e)r=0;else if(129==e||301==e)r=2;if(0==e||4==e)r=3;else if(1==e||5==e)r=1;else if(2==e||6==e)r=0;else if(3==e||7==e)var r=2;this.ctxBlood.drawImage(this.bloodImg,this.bloodW*r,this.bloodH*o,this.bloodW,this.bloodH,t-this.bloodW/2,i-this.bloodH/2+this.roleH/4,this.bloodW,this.bloodH)},drawPenBlood:function(e,t,i){ctxButer.save(),ctxButer.clearRect(0,0,roleCvs.width,roleCvs.height),ctxButer.translate(e.x+e.zombieW/2,e.y+e.zombieH/2),ctxButer.rotate(i),ctxButer.drawImage(this.penBloodImg,0,0,this.penBloodW,this.penBloodH,-this.penBloodW/2,-this.penBloodH/2,this.penBloodW,this.penBloodH),ctxButer.restore()}}),util.extend(Bullet.prototype,{bulletFly:function(e,t,i){switch(ctxBullet.arc(e,t,this.killRang,0,2*Math.PI),ctxBullet.closePath(),ctxBullet.fill(),i){case 172:ctxBullet.clearRect(e,t,_this.bulletImg.width,_this.bulletImg.height),t-=14,ctxBullet.drawImage(_this.bulletImg,e,t);break;case 215:ctxBullet.clearRect(e,t,_this.bulletImg2.width,_this.bulletImg2.height),e+=14,t-=14,ctxBullet.drawImage(_this.bulletImg2,e,t);break;case 258:ctxBullet.clearRect(e,t,_this.bulletImg3.width,_this.bulletImg3.height),e+=14,ctxBullet.drawImage(_this.bulletImg3,e,t);break;case 301:ctxBullet.clearRect(e,t,_this.bulletImg4.width,_this.bulletImg4.height),e+=14,t+=14,ctxBullet.drawImage(_this.bulletImg4,e,t);break;case 0:ctxBullet.clearRect(e,t,_this.bulletImg5.width,_this.bulletImg5.height),t+=14,ctxBullet.drawImage(_this.bulletImg5,e,t);break;case 43:ctxBullet.clearRect(e,t-_this.roleH/2,_this.bulletImg6.width,_this.bulletImg6.height),e-=14,t+=14,ctxBullet.drawImage(_this.bulletImg6,e,t-_this.roleH/2);break;case 86:ctxBullet.clearRect(e,t-_this.roleH/5,_this.bulletImg7.width,_this.bulletImg7.height),e-=14,ctxBullet.drawImage(_this.bulletImg7,e,t-_this.roleH/5);break;case 129:ctxBullet.clearRect(e,t,_this.bulletImg8.width,_this.bulletImg8.height),t-=14,e-=14,ctxBullet.drawImage(_this.bulletImg8,e,t)}},createBullet:function(){if(this.bulletIng.length>0)for(var e=0;e<this.bulletIng.length;e++)this.bulletIng[e]}}),util.extend(Zombie.prototype,{init:function(){this.createZombie(),this.drawZombie()},randomZombie:function(){var e=Math.random()>.5?Math.floor(100*Math.random()-200):Math.floor(200*Math.random()+1200),t=Math.floor(285*Math.random()+170);this.zombieArr.push({x:e,y:t,zombieW:this.zombieImg.width/8,zombieH:this.zombieImg.height/9,index:this.temp++,zomX:0,zomY:50,zombieIndex:1,zombieDire:1,life:Math.random()>.1?2:5,dizziness:0,isDie:!1,zombieSpeed:Math.random()>.1?Math.floor(10*Math.random()+8)/10:2.5,attack:150,backUpTime:0,autoMove:0,tempSpeed:0,autoW:0,autoH:0})},createZombie:function(){var e=this,t=!0,i=!0,o=!0,r=!0,s=!0;config.createZombieTime=setInterval(function(){if(game.isPause);else{if(config.tempsIndex<60&&e.randomZombie(),config.tempsIndex>30&&t){t=!1;for(a=0;a<20;a++)e.randomZombie()}if(config.tempsIndex>70&&i){i=!1;for(a=0;a<30;a++)e.randomZombie()}if(config.tempsIndex>100&&o){o=!1;for(a=0;a<50;a++)e.randomZombie()}if(config.tempsIndex>160&&r){r=!1;for(a=0;a<100;a++)e.randomZombie()}if(config.tempsIndex>240&&s){s=!1;for(var a=0;a<200;a++)e.randomZombie()}}},1e3)},drawZombie:function(){this.ctxZombie.clearRect(0,0,roleCvs.width,roleCvs.height);for(var e=0;e<this.zombieArr.length;e++)if(this.zombieArr[e].life<0&&this.zombieArr[e].backUpTime<=0){if(-1==this.zombieArr[e].life){if(0==this.zombieArr[e].zombieDire||1==this.zombieArr[e].zombieDire)t=0;else if(4==this.zombieArr[e].zombieDire||5==this.zombieArr[e].zombieDire)t=2;else if(2==this.zombieArr[e].zombieDire||3==this.zombieArr[e].zombieDire)t=3;else if(7==this.zombieArr[e].zombieDire||6==this.zombieArr[e].zombieDire)var t=1;this.ctxZomdie.drawImage(this.zomDieImg,0,this.zomDieH*t,this.zomDieW,this.zomDieH,this.zombieArr[e].x,this.zombieArr[e].y,this.zomDieW,this.zomDieH),this.zombieArr[e].life=-2}}else{this.zombieArr[e].zomY=50*Math.floor(this.zombieArr[e].zombieIndex/5);var i=Math.abs(this.zombieArr[e].zombieSpeed);this.zombieArr[e].zombieIndex+=i,this.zombieArr[e].zombieIndex>44&&(this.zombieArr[e].zombieIndex=5),this.zombieArr[e].zomX=43*this.zombieArr[e].zombieDire,this.ctxZombie.drawImage(this.zombieImg,this.zombieArr[e].zomX,this.zombieArr[e].zomY,this.zombieW,this.zombieH,this.zombieArr[e].x,this.zombieArr[e].y,this.zombieW,this.zombieH)}},zombieMove:function(e){var t=e.role1.x,i=e.role1.y;if(game.dobuleRole)var o=e.role2.x,r=e.role2.y;ctxRole.beginPath(),ctxRole.arc(t,i,30,0,2*Math.PI),ctxRole.closePath(),ctxRole.arc(o,r,30,0,2*Math.PI),ctxRole.closePath(),ctxButer.beginPath(),ctxButer.arc(t,i,20,0,2*Math.PI),ctxButer.closePath(),ctxButer.arc(o,r,20,0,2*Math.PI),ctxButer.closePath();for(var s=0;s<this.zombieArr.length;s++)if(ctxGas.isPointInPath(this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&-1!=this.zombieArr[s].life&&this.zombieArr[s].life>=0&&(this.zombieArr[s].backUpTime=10,game.role.backUp(this.zombieArr[s].zombieDire,this.zombieArr[s],3,!0),this.zombieArr[s].life=-1),!(this.zombieArr[s].life<0||this.zombieArr[s].backUpTime>0)){if(ctxButer.isPointInPath(this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2))this.zombieArr[s].attack--,this.zombieArr[s].zombieSpeed=-Math.abs(this.zombieArr[s].zombieSpeed);else if(ctxRole.isPointInPath(this.zombieArr[s].x+this.zombieW/2,this.zombieArr[s].y+this.zombieH/2)){this.zombieArr[s].attack--;var a=this.zombieArr[s].x+this.zombieArr[s].zombieW/2-t,l=this.zombieArr[s].y+this.zombieArr[s].zombieH/2-i;if(game.dobuleRole){var m=this.zombieArr[s].x+this.zombieArr[s].zombieW/2-o,h=this.zombieArr[s].y+this.zombieArr[s].zombieH/2-r;a*a+l*l<m*m+h*h?(game.role.roundZombie++,game.role.roundZombie>=12&&(game.role.roundZombie=12)):(game.role2.roundZombie++,game.role2.roundZombie>=12&&(game.role2.roundZombie=12))}else game.role.roundZombie++,game.role.roundZombie>=12&&(game.role.roundZombie=12);if(this.zombieArr[s].attack<0){game.role.roleCx,game.role.roleCy;if(game.role2){game.role2.roleCx,game.role.roleW,game.role2.roleCy,game.role.roleH;var c=this.zombieArr[s].x+this.zombieArr[s].zombieW/2-t,n=this.zombieArr[s].y+this.zombieArr[s].zombieH/2-i,b=this.zombieArr[s].x+this.zombieArr[s].zombieW/2-o,g=this.zombieArr[s].y+this.zombieArr[s].zombieH/2-r;c*c+n*n<b*b+g*g?(game.role.isDie=!0,game.role.roleSpeed=game.role.roleTempSpeed,game.role.roleImg=config.RoleDieImg):(game.role2.isDie=!0,game.role2.roleSpeed=game.role2.roleTempSpeed,game.role2.roleImg=config.RoleDieImg)}else game.role.isDie=!0,game.role.roleImg=config.RoleDieImg,config.drawText(config.tempsIndex+""),clearInterval(config.temps),setTimeout(function(){gameOverCvs.style.display="block",game.isPause=!0},1e3);this.zombieArr[s].attack=150}continue}if(this.zombieArr[s].attack=150,!e.role1.isDie)var d=this.zombieArr[s].x+this.zombieArr[s].zombieW/2-t,u=this.zombieArr[s].y+this.zombieArr[s].zombieH/2-i,x=Math.pow(Math.pow(d,2)+Math.pow(u,2),.5);if(e.role1.isDie&&!game.dobuleRole&&(game.role.roleImg=config.RoleDieImg,config.drawText(config.tempsIndex+""),clearInterval(config.temps),setTimeout(function(){gameOverCvs.style.display="block",game.isPause=!0},1e3)),game.dobuleRole&&!e.role2.isDie)var f=this.zombieArr[s].x+this.zombieArr[s].zombieW/2-o,p=this.zombieArr[s].y+this.zombieArr[s].zombieH/2-r,y=Math.pow(Math.pow(f,2)+Math.pow(p,2),.5);if(game.dobuleRole){if(e.role1.isDie&&e.role2.isDie)return clearInterval(config.temps),config.drawText(config.tempsIndex+""),void setTimeout(function(){gameOverCvs.style.display="block",game.isPause=!0},1e3);if(e.role1.isDie){var z=y,I=f,v=p;if(game.role2.pretend)var v=0,I=100,z=100}else if(e.role2.isDie){var z=x,I=d,v=u;if(game.role.pretend)var v=0,I=100,z=100}else if(x<y){var z=x,I=d,v=u;game.role.pretend&&(z=y,I=f,v=p)}else{var z=y,I=f,v=p;game.role2.pretend&&(z=x,I=d,v=u)}}else{var z=x,I=d,v=u;if(game.role.pretend)var v=0,I=100,z=100}var w=180*-Math.asin(v/z)/Math.PI;this.zombieArr[s].life<0||(this.zombieArr[s].autoMove<=0?(w<-67.5&&(this.zombieArr[s].zombieDire=4,this.zombieArr[s].y-=this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].y+=this.zombieArr[s].zombieSpeed,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I)),w>67.5&&(this.zombieArr[s].zombieDire=0,this.zombieArr[s].y+=this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].y-=this.zombieArr[s].zombieSpeed,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I)),w<22&&w>-22&&(I>0&&(this.zombieArr[s].zombieDire=2,this.zombieArr[s].x-=this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].x+=this.zombieArr[s].zombieSpeed,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I)),I<0&&(this.zombieArr[s].zombieDire=6,this.zombieArr[s].x+=this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].x-=this.zombieArr[s].zombieSpeed,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I))),w<-23&&w>-67&&(I>0&&(this.zombieArr[s].zombieDire=3,this.zombieArr[s].x-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,this.zombieArr[s].y-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].x+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].y+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I)),I<0&&(this.zombieArr[s].zombieDire=5,this.zombieArr[s].x+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,this.zombieArr[s].y-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].x-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].y+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I))),w>23&&w<67&&(I>0&&(this.zombieArr[s].zombieDire=1,this.zombieArr[s].x-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,this.zombieArr[s].y+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].x+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].y-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I)),I<0&&(this.zombieArr[s].zombieDire=7,this.zombieArr[s].x+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,this.zombieArr[s].y+=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed,util.isObstacle(ctxObstacle,this.zombieArr[s].x+this.zombieArr[s].zombieW/2,this.zombieArr[s].y+this.zombieArr[s].zombieH/2)&&(this.zombieArr[s].x-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].y-=Math.pow(2,.5)/2*this.zombieArr[s].zombieSpeed+.5,this.zombieArr[s].autoMove=20,this.zombieArr[s].autoH=v,this.zombieArr[s].autoW=I))),(w>22&&w<23||w<-22&&w>-23||w>67&&w<67.5||w<-67&&w>67.5)&&(this.zombieArr[s].autoMove=20,this.autoMove(this.zombieArr[s].zombieDire,this.zombieArr[s],this.zombieArr[s].autoW,this.zombieArr[s].autoH=v))):this.autoMove(this.zombieArr[s].zombieDire,this.zombieArr[s],this.zombieArr[s].autoW,this.zombieArr[s].autoH=v),this.zombieArr[s].zombieSpeed=Math.abs(this.zombieArr[s].zombieSpeed))}game.role.isDie||(game.role.roleSpeed=game.role.roleTempSpeed-game.role.roundZombie*game.role.roleBody,game.role.roleSpeed<0&&(game.role.roleSpeed=0)),game.dobuleRole&&(game.role2.isDie||(game.role2.roleSpeed=game.role2.roleTempSpeed-game.role2.roundZombie*game.role2.roleBody,game.role2.roleSpeed<0&&(game.role2.roleSpeed=0),game.role2.roundZombie=0)),game.role.roundZombie=0,this.drawZombie()},autoMove:function(e,t,i,o){if(20==t.autoMove)switch(e){case 0:t.zombieDire=i>0?2:6;break;case 1:t.zombieDire=2;break;case 2:t.zombieDire=o>0?4:0;break;case 3:t.zombieDire=4;break;case 4:t.zombieDire=i>0?2:6;break;case 5:t.zombieDire=4;break;case 6:t.zombieDire=o>0?4:0;break;case 7:t.zombieDire=0}switch(t.autoMove--,t.zombieDire){case 0:t.y+=t.zombieSpeed,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.y-=t.zombieSpeed,t.zombieDire=4);break;case 2:t.x-=t.zombieSpeed,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x+=t.zombieSpeed,t.zombieDire=6);break;case 4:t.y-=t.zombieSpeed,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.y+=t.zombieSpeed,t.zombieDire=0);break;case 6:t.x+=t.zombieSpeed,util.isObstacle(ctxObstacle,t.x+t.zombieW/2,t.y+t.zombieH/2)&&(t.x-=t.zombieSpeed,t.zombieDire=2)}}}),util.extend(CreateGas.prototype,{init:function(){this.drawGas()},drawBombScope:function(e,t){var i=0,o=this,r=document.getElementsByTagName("canvas");config.hasSound&&(config.audios["baozha-da3"].currentTime=0,config.audios["baozha-da3"].play()),this.ctxGas.arc(e,t,100,0,2*Math.PI),this.ctxGas.closePath(),this.ctxGas.drawImage(this.bombImg,0,0,this.bombW,this.bombH,e-this.bombW/2,t-this.bombH/2,this.bombW,this.bombH);for(var s=setInterval(function(){i++,o.ctxGas.clearRect(e-o.bombW/2,t-o.bombH/2,o.bombW,o.bombH),o.ctxGas.beginPath(),o.ctxGas.drawImage(o.bombImg,0,o.bombH*i,o.bombW,o.bombH,e-o.bombW/2,t-o.bombH/2,o.bombW,o.bombH),console.log(o.bombH*i),i>10&&(o.drawGas(),clearInterval(s),i=0)},50),a=setInterval(function(){for(var e=-Math.floor(20*Math.random()+590),t=-Math.floor(20*Math.random()+290),o=0;o<r.length;o++)i<4?(r[o].style.marginTop=t+"px",r[o].style.marginLeft=e+"px"):(r[o].style.marginTop="-300px",r[o].style.marginLeft="-600px");i>4&&clearInterval(a)},5),l=0;l<this.bombArr.length;l++)!this.bombArr[l].isBomb&&this.ctxGas.isPointInPath(this.bombArr[l].x,this.bombArr[l].y)&&((o=this).bombArr[l].isBomb=!0,function(e){var t=e;setTimeout(function(){o.drawBombScope(o.bombArr[t].x,o.bombArr[t].y)},100)}(l))},drawGas:function(){this.ctxGas.clearRect(0,0,gasCvs.width,gasCvs.height);for(var e=0;e<this.bombArr.length;e++)this.bombArr[e].isBomb||this.ctxGas.drawImage(this.gasImg,this.bombArr[e].x-this.gasW/2,this.bombArr[e].y-this.gasH/2)}}),util.extend(Mine.prototype,{drawMine:function(){var e=this;0==e.mineArr.length&&clearInterval(e.timer),this.ctxMine.clearRect(0,0,mineCvs.width,mineCvs.height);for(var t=0;t<this.mineArr.length;t++)this.mineArr[t].timing<=0?(this.mineArr[t].timing=0,this.drawMineScope(this.mineArr[t].x,this.mineArr[t].y),this.mineArr.shift(),t-=1):(this.mineArr[t].timing--,this.ctxMine.drawImage(this.mineImg,0,(3-this.mineArr[t].timing)*this.mineImgH,this.mineImgW,this.mineImgH,this.mineArr[t].x-this.mineImgW/2,this.mineArr[t].y-this.mineImgH/2,this.mineImgW,this.mineImgH))},drawMineScope:function(e,t){var i=0,o=this,r=document.getElementsByTagName("canvas");config.hasSound&&(config.audios["baozha-da3"].currentTime=0,config.audios["baozha-da3"].play()),this.ctxGas.arc(e,t,100,0,2*Math.PI),this.ctxGas.closePath(),this.ctxMineEffect.drawImage(this.mineeffectImg,0,0,this.mineeffectImgW,this.mineeffectImgH,e-this.mineeffectImgW/2,t-this.mineeffectImgH/2,this.mineeffectImgW,this.mineeffectImgH);var s=setInterval(function(){i++,o.ctxMineEffect.clearRect(e-o.mineeffectImgW/2,t-o.mineeffectImgH/2,o.mineeffectImgW,o.mineeffectImgH),o.ctxGas.beginPath(),o.ctxMineEffect.drawImage(o.mineeffectImg,0,o.mineeffectImgH*i,o.mineeffectImgW,o.mineeffectImgH,e-o.mineeffectImgW/2,t-o.mineeffectImgH/2,o.mineeffectImgW,o.mineeffectImgH),i>10&&(game.gas.drawGas(),clearInterval(s))},50),a=setInterval(function(){for(var e=-Math.floor(10*Math.random()+595),t=-Math.floor(10*Math.random()+295),o=0;o<r.length;o++)i<4?(r[o].style.marginTop=t+"px",r[o].style.marginLeft=e+"px"):(r[o].style.marginTop="-300px",r[o].style.marginLeft="-600px");i>4&&clearInterval(a)},5)},isNull:function(){return 0==this.mineArr.length},timingDraw:function(){var e=this;this.isNull()||(this.drawMine(),clearInterval(this.timer),this.timer=setInterval(function(){game.isPause||e.drawMine()},1e3))}}),util.extend(GameProp.prototype,{drawProp:function(){this.propType=Math.floor(5*Math.random()),game.dobuleRole||4!=this.propType||(this.propType=3),game.dobuleRole&&4==this.propType&&(game.role.isDie||game.role2.isDie||(this.propType=Math.floor(4*Math.random())));for(var e=1200*Math.random(),t=600*Math.random();ctxObstacle.isPointInPath(e,t);)e=1200*Math.random(),t=600*Math.random(),console.log(90);ctxGameProp.beginPath(),ctxGameProp.clearRect(0,0,gamePropCvs.width,gamePropCvs.height),ctxGameProp.drawImage(this.propImg,0,this.propImgH*this.propType,this.propImgW,this.propImgH,e-this.propImgW/2,t-this.propImgH/2,this.propImgW,this.propImgH),ctxGameProp.arc(e,t,20,0,2*Math.PI),ctxGameProp.closePath()}}),SailorGame.prototype={constructor:SailorGame,run:function(){var e=this,t=new Image;t.src="./images/loadIngImg.png",t.onload=function(){e.loadIngGame=new GameLoad({ctxGameloading:ctxGameloading,loadIngImg:t,width:350,height:34,cX:425,cY:438}),loadAudio(e.audioObj,function(t){config.audios=t,console.log("音乐加载完毕"),loadImg(e.imgObj,function(t){config.imgobj=t,bulletObj.bulletImg=t.bullet_1,bulletObj.bulletImg2=t.bullet_2,bulletObj.bulletImg3=t.bullet_3,bulletObj.bulletImg4=t.bullet_4,bulletObj.bulletImg5=t.bullet_5,bulletObj.bulletImg6=t.bullet_6,bulletObj.bulletImg7=t.bullet_7,bulletObj.bulletImg8=t.bullet_8,e.playView=new PlayGame({ctxPlayGame:ctxPlayGame,playGameImg:t.play_view,playGameImg2:t.play_view2}),e.overGame=new GameOver({ctxGameOver:ctxGameOver,gameOverImg:t.gameOver}),e.pauseGame=new PauseGame({ctxPauseGame:ctxPauseGame}),e.scroeGame=new GameScroe({ctxGameScore:ctxGameScore,startImg:t.start,stopImg:t.stop,restartImg:t.restart,bg_musicImg:t.bg_music,soundImg:t.sound,sound2Img:t.sound2,bg_music2Img:t.bg_music2}),e.propGame=new GameProp({ctxGameProp:ctxGameProp,propImg:t.propimg}),e.checkView=new CheckGame({ctxCheckGame:ctxCheckGame,check_view:t.check_view,check_view_top:t.check_view_top,check_view_bottom:t.check_view_bottom,check1:t.check1,check2:t.check2,check3:t.check3,check4:t.check4,check5:t.check5,check6:t.check6,check7:t.check7,check8:t.check8,single:t.single,double:t.double}),config.RoleDieImg=t.roleDie})})}},process:function(){var e=config.imgobj;this.dobuleRole=config.dobuleRole,this.gameBg=new DrawGameBg({ctxBg:ctxBg,bgImg:e[config.gameBg[config.checked][0]]}),this.gameObstacle=new Obstacle({ctxObstacle:ctxObstacle,obstacleImg:e[config.gameBg[config.checked][1]]}),this.role=createRole(e.role,465,171,!0,!1,ctxBlood,e.blood,e.penBlood),this.roleCtrl1=new KeyCtroller(this.role),this.dobuleRole&&(this.role2=createRole(e.role2,681,171,!1,!0,ctxBlood,e.blood,e.penBlood),this.roleCtrl2=new KeyCtroller(this.role2,38,39,40,37)),this.zombie=new Zombie({ctxZombie:ctxZombie,zombieImg:e.zombie,ctxZomdie:ctxZomdie,zomDieImg:e.zomDie}),this.gas=new CreateGas({ctxGas:ctxGas,gasImg:e.gas,bombImg:e.bombeffect,bombArr:config.bombArr[config.checked]}),this.mineProp=new Mine({ctxMine:ctxMine,mineImg:e.mine,mineeffectImg:e.mineeffect,ctxGas:ctxGas,ctxMineEffect:ctxMineEffect})},render:function(){var e=this;config.hasMusic&&(config.audios.bkg.loop=!0,config.audios.bkg.play()),this.isPause=!1,function t(){e.isGameOver||(e.isPause||(e.role.clearRole(),e.role.init(),e.roleCtrl1.moveStep(),e.role2&&e.role2.init(),e.role2&&e.roleCtrl2.moveStep(),e.role.createBullet(e.zombie.zombieArr),e.role2&&e.role2.createBullet(e.zombie.zombieArr),e.dobuleRole?e.roleXY={role1:{x:e.role.roleCx+e.role.roleW/2,y:e.role.roleCy+e.role.roleH/2,isDie:e.role.isDie},role2:{x:e.role2.roleCx+e.role2.roleW/2,y:e.role2.roleCy+e.role2.roleH/2,isDie:e.role2.isDie}}:e.roleXY={role1:{x:e.role.roleCx+e.role.roleW/2,y:e.role.roleCy+e.role.roleH/2,isDie:e.role.isDie}},e.zombie.zombieMove(e.roleXY)),requestAnimationFrame(t))}()},pause:function(){config.audios.enter.play(),this.isPause=!this.isPause,this.isPause?(pauseGameCvs.style.display="block",clearInterval(config.temps),config.temps=null):(pauseGameCvs.style.display="none",config.temps=setInterval(config.tempsFn,1e3))},gameOverLogic:function(){game.isGameOver=!0,game.checkView.callbackIn=null,gameOverCvs.style.display="none",checkGameCvs.style.display="block",game.role=null,game.role2=null,game.roleCtrl1=null,game.roleCtrl2=null,game.scroeGame.drawPause(!1),pauseGameCvs.style.display="none",ctxBlood.clearRect(0,0,bloodCvs.width,bloodCvs.height),ctxZomdie.clearRect(0,0,dieZombieCvs.width,dieZombieCvs.height),clearInterval(config.temps),config.temps=null,config.tempsIndex=0;for(var e=0;e<config.bombArr[config.checked].length;e++)config.bombArr[config.checked][e].isBomb=!1;config.audios.bkg.pause()}};var game=new SailorGame;game.run();